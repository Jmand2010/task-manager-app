<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; }
        .lucide { width: 1rem; height: 1rem; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { 
            Plus, Phone, Mail, Building2, FolderOpen, FileText, 
            PenTool, CheckSquare, Edit3, Trash2, Calendar, 
            AlertCircle, Search 
        } = lucide;

        const TaskManager = () => {
          const [tasks, setTasks] = useState([]);
          const [newTask, setNewTask] = useState({ 
            title: '', 
            category: 'phone-calls', 
            priority: 'medium', 
            dueDate: '',
            notes: ''
          });
          const [filter, setFilter] = useState('all');
          const [searchTerm, setSearchTerm] = useState('');
          const [editingTask, setEditingTask] = useState(null);
          const [showAddForm, setShowAddForm] = useState(false);

          const categories = [
            { id: 'phone-calls', name: 'Phone Calls', icon: Phone, color: 'border-l-blue-500' },
            { id: 'emails', name: 'Emails', icon: Mail, color: 'border-l-green-500' },
            { id: 'suppliers', name: 'Suppliers', icon: Building2, color: 'border-l-orange-500' },
            { id: 'projects', name: 'Projects', icon: FolderOpen, color: 'border-l-purple-500' },
            { id: 'estimates', name: 'Estimates/Proposals', icon: FileText, color: 'border-l-indigo-500' },
            { id: 'drawings', name: 'Drawings', icon: PenTool, color: 'border-l-pink-500' },
            { id: 'random', name: 'Random Tasks', icon: CheckSquare, color: 'border-l-gray-500' }
          ];

          const priorities = [
            { id: 'low', name: 'Low', color: 'text-gray-500' },
            { id: 'medium', name: 'Medium', color: 'text-yellow-600' },
            { id: 'high', name: 'High', color: 'text-red-600' }
          ];

          // Load tasks from localStorage
          useEffect(() => {
            try {
              const savedTasks = localStorage.getItem('taskManagerTasks');
              if (savedTasks) {
                setTasks(JSON.parse(savedTasks));
              }
            } catch (error) {
              console.log('No saved tasks found');
            }
          }, []);

          // Save tasks to localStorage
          useEffect(() => {
            try {
              localStorage.setItem('taskManagerTasks', JSON.stringify(tasks));
            } catch (error) {
              console.log('Could not save tasks');
            }
          }, [tasks]);

          const addTask = () => {
            if (!newTask.title.trim()) return;
            
            const task = {
              id: Date.now(),
              ...newTask,
              completed: false,
              createdAt: new Date().toISOString()
            };
            
            setTasks([task, ...tasks]);
            setNewTask({ title: '', category: 'phone-calls', priority: 'medium', dueDate: '', notes: '' });
            setShowAddForm(false);
          };

          const toggleTask = (id) => {
            setTasks(tasks.map(task => 
              task.id === id ? { ...task, completed: !task.completed } : task
            ));
          };

          const deleteTask = (id) => {
            setTasks(tasks.filter(task => task.id !== id));
          };

          const updateTask = (id, updates) => {
            setTasks(tasks.map(task => 
              task.id === id ? { ...task, ...updates } : task
            ));
            setEditingTask(null);
          };

          const getCategoryInfo = (categoryId) => {
            return categories.find(cat => cat.id === categoryId) || categories[0];
          };

          const getPriorityInfo = (priorityId) => {
            return priorities.find(p => p.id === priorityId) || priorities[1];
          };

          const getDateStatus = (dueDate) => {
            if (!dueDate) return null;
            
            const today = new Date();
            const due = new Date(dueDate);
            const diffTime = due - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays < 0) return { status: 'overdue', days: Math.abs(diffDays), color: 'text-red-700 bg-red-100' };
            if (diffDays === 0) return { status: 'today', days: 0, color: 'text-red-600 bg-red-50' };
            if (diffDays === 1) return { status: 'tomorrow', days: 1, color: 'text-orange-600 bg-orange-50' };
            if (diffDays <= 3) return { status: 'soon', days: diffDays, color: 'text-yellow-600 bg-yellow-50' };
            if (diffDays <= 7) return { status: 'week', days: diffDays, color: 'text-blue-600 bg-blue-50' };
            return { status: 'future', days: diffDays, color: 'text-gray-600 bg-gray-50' };
          };

          const filteredTasks = tasks.filter(task => {
            const matchesFilter = filter === 'all' || 
                                 filter === 'completed' && task.completed ||
                                 filter === 'pending' && !task.completed ||
                                 filter === task.category;
            
            const matchesSearch = task.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                 task.notes.toLowerCase().includes(searchTerm.toLowerCase());
            
            return matchesFilter && matchesSearch;
          });

          const TaskForm = ({ task, onSave, onCancel }) => {
            const [formData, setFormData] = useState(task || newTask);

            const handleSubmit = () => {
              if (!formData.title.trim()) return;
              onSave(formData);
            };

            return React.createElement('div', { className: "bg-white p-4 rounded-lg shadow-lg border-2 border-blue-200" },
              React.createElement('div', { className: "space-y-4" },
                React.createElement('div', null,
                  React.createElement('input', {
                    type: "text",
                    placeholder: "Task title...",
                    value: formData.title,
                    onChange: (e) => setFormData({...formData, title: e.target.value}),
                    className: "w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg"
                  })
                ),
                
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                  React.createElement('div', null,
                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Category"),
                    React.createElement('select', {
                      value: formData.category,
                      onChange: (e) => setFormData({...formData, category: e.target.value}),
                      className: "w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                    }, categories.map(cat => 
                      React.createElement('option', { key: cat.id, value: cat.id }, cat.name)
                    ))
                  ),
                  
                  React.createElement('div', null,
                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Priority"),
                    React.createElement('select', {
                      value: formData.priority,
                      onChange: (e) => setFormData({...formData, priority: e.target.value}),
                      className: "w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                    }, priorities.map(p => 
                      React.createElement('option', { key: p.id, value: p.id }, p.name)
                    ))
                  )
                ),

                React.createElement('div', null,
                  React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Due Date (Optional)"),
                  React.createElement('input', {
                    type: "date",
                    value: formData.dueDate,
                    onChange: (e) => setFormData({...formData, dueDate: e.target.value}),
                    className: "w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                  })
                ),

                React.createElement('div', null,
                  React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Notes (Optional)"),
                  React.createElement('textarea', {
                    placeholder: "Additional details...",
                    value: formData.notes,
                    onChange: (e) => setFormData({...formData, notes: e.target.value}),
                    className: "w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none h-20 resize-none"
                  })
                ),

                React.createElement('div', { className: "flex gap-3 pt-2" },
                  React.createElement('button', {
                    onClick: handleSubmit,
                    className: "flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors font-medium"
                  }, task ? 'Update Task' : 'Add Task'),
                  React.createElement('button', {
                    onClick: onCancel,
                    className: "flex-1 bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 transition-colors font-medium"
                  }, "Cancel")
                )
              )
            );
          };

          return React.createElement('div', { className: "min-h-screen bg-gray-50 p-4" },
            React.createElement('div', { className: "max-w-4xl mx-auto" },
              // Header
              React.createElement('div', { className: "bg-white rounded-lg shadow-sm p-6 mb-6" },
                React.createElement('h1', { className: "text-3xl font-bold text-gray-800 mb-4" }, "Task Manager"),
                
                // Search and Filter Bar
                React.createElement('div', { className: "flex flex-col md:flex-row gap-4 mb-4" },
                  React.createElement('div', { className: "flex-1 relative" },
                    React.createElement(Search, { className: "absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" }),
                    React.createElement('input', {
                      type: "text",
                      placeholder: "Search tasks...",
                      value: searchTerm,
                      onChange: (e) => setSearchTerm(e.target.value),
                      className: "w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                    })
                  ),
                  
                  React.createElement('div', { className: "flex gap-2" },
                    React.createElement('select', {
                      value: filter,
                      onChange: (e) => setFilter(e.target.value),
                      className: "px-4 py-2 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none bg-white"
                    }, 
                      React.createElement('option', { value: "all" }, "All Tasks"),
                      React.createElement('option', { value: "pending" }, "Pending"),
                      React.createElement('option', { value: "completed" }, "Completed"),
                      categories.map(cat => 
                        React.createElement('option', { key: cat.id, value: cat.id }, cat.name)
                      )
                    ),
                    
                    React.createElement('button', {
                      onClick: () => setShowAddForm(!showAddForm),
                      className: "bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 font-medium"
                    }, 
                      React.createElement(Plus, { className: "w-5 h-5" }),
                      "Add Task"
                    )
                  )
                ),

                // Task Stats
                React.createElement('div', { className: "grid grid-cols-2 md:grid-cols-4 gap-4 text-center" },
                  React.createElement('div', { className: "bg-blue-50 p-3 rounded-lg" },
                    React.createElement('div', { className: "text-2xl font-bold text-blue-600" }, tasks.length),
                    React.createElement('div', { className: "text-sm text-gray-600" }, "Total")
                  ),
                  React.createElement('div', { className: "bg-yellow-50 p-3 rounded-lg" },
                    React.createElement('div', { className: "text-2xl font-bold text-yellow-600" }, tasks.filter(t => !t.completed).length),
                    React.createElement('div', { className: "text-sm text-gray-600" }, "Pending")
                  ),
                  React.createElement('div', { className: "bg-green-50 p-3 rounded-lg" },
                    React.createElement('div', { className: "text-2xl font-bold text-green-600" }, tasks.filter(t => t.completed).length),
                    React.createElement('div', { className: "text-sm text-gray-600" }, "Completed")
                  ),
                  React.createElement('div', { className: "bg-red-50 p-3 rounded-lg" },
                    React.createElement('div', { className: "text-2xl font-bold text-red-600" }, 
                      tasks.filter(t => t.dueDate && getDateStatus(t.dueDate)?.status === 'overdue' && !t.completed).length
                    ),
                    React.createElement('div', { className: "text-sm text-gray-600" }, "Overdue")
                  )
                )
              ),

              // Add Task Form
              showAddForm && React.createElement('div', { className: "mb-6" },
                React.createElement(TaskForm, {
                  onSave: (taskData) => {
                    const task = {
                      id: Date.now(),
                      ...taskData,
                      completed: false,
                      createdAt: new Date().toISOString()
                    };
                    setTasks([task, ...tasks]);
                    setShowAddForm(false);
                  },
                  onCancel: () => setShowAddForm(false)
                })
              ),

              // Tasks List
              React.createElement('div', { className: "space-y-3" },
                filteredTasks.length === 0 ? 
                  React.createElement('div', { className: "bg-white p-8 rounded-lg shadow-sm text-center" },
                    React.createElement(CheckSquare, { className: "w-16 h-16 text-gray-300 mx-auto mb-4" }),
                    React.createElement('h3', { className: "text-xl font-medium text-gray-500 mb-2" }, "No tasks found"),
                    React.createElement('p', { className: "text-gray-400" }, 
                      searchTerm ? 'Try adjusting your search terms' : 'Add your first task to get started!'
                    )
                  ) :
                  filteredTasks.map(task => {
                    const categoryInfo = getCategoryInfo(task.category);
                    const priorityInfo = getPriorityInfo(task.priority);
                    const dateStatus = getDateStatus(task.dueDate);
                    const Icon = categoryInfo.icon;

                    return React.createElement('div', { 
                      key: task.id, 
                      className: `bg-white p-4 rounded-lg shadow-sm border-l-4 ${categoryInfo.color} ${task.completed ? 'opacity-60' : ''}`
                    },
                      editingTask === task.id ? 
                        React.createElement(TaskForm, {
                          task: task,
                          onSave: (updates) => updateTask(task.id, updates),
                          onCancel: () => setEditingTask(null)
                        }) :
                        React.createElement('div', { className: "flex items-start gap-4" },
                          React.createElement('input', {
                            type: "checkbox",
                            checked: task.completed,
                            onChange: () => toggleTask(task.id),
                            className: "mt-1 w-5 h-5 text-blue-600 rounded focus:ring-blue-500"
                          }),
                          
                          React.createElement('div', { className: "flex-1 min-w-0" },
                            React.createElement('div', { className: "flex items-center gap-3 mb-2" },
                              React.createElement(Icon, { className: "w-5 h-5 text-blue-600" }),
                              React.createElement('h3', { 
                                className: `text-lg font-medium ${task.completed ? 'line-through text-gray-500' : 'text-gray-800'}`
                              }, task.title),
                              React.createElement('span', { 
                                className: `text-sm font-medium ${priorityInfo.color}`
                              }, priorityInfo.name)
                            ),
                            
                            React.createElement('div', { className: "flex flex-wrap items-center gap-4 text-sm text-gray-600" },
                              React.createElement('span', { className: "bg-gray-100 px-2 py-1 rounded" }, categoryInfo.name),
                              
                              task.dueDate && React.createElement('div', { 
                                className: `flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${dateStatus ? dateStatus.color : 'text-gray-600 bg-gray-100'}`
                              },
                                React.createElement(Calendar, { className: "w-3 h-3" }),
                                dateStatus?.status === 'overdue' && `${dateStatus.days} days overdue`,
                                dateStatus?.status === 'today' && 'Due today',
                                dateStatus?.status === 'tomorrow' && 'Due tomorrow',
                                dateStatus?.status === 'soon' && `Due in ${dateStatus.days} days`,
                                dateStatus?.status === 'week' && `Due in ${dateStatus.days} days`,
                                dateStatus?.status === 'future' && new Date(task.dueDate).toLocaleDateString(),
                                !dateStatus && new Date(task.dueDate).toLocaleDateString(),
                                dateStatus?.status === 'overdue' && React.createElement(AlertCircle, { className: "w-3 h-3" })
                              )
                            ),
                            
                            task.notes && React.createElement('p', { className: "mt-2 text-gray-600 text-sm bg-gray-50 p-2 rounded" }, task.notes)
                          ),
                          
                          React.createElement('div', { className: "flex gap-2" },
                            React.createElement('button', {
                              onClick: () => setEditingTask(task.id),
                              className: "p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors"
                            }, React.createElement(Edit3, { className: "w-4 h-4" })),
                            React.createElement('button', {
                              onClick: () => deleteTask(task.id),
                              className: "p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors"
                            }, React.createElement(Trash2, { className: "w-4 h-4" }))
                          )
                        )
                    );
                  })
              )
            )
          );
        };

        ReactDOM.render(React.createElement(TaskManager), document.getElementById('root'));
    </script>
</body>
</html>
